<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
**Table of Contents**  *generated with [DocToc](https://github.com/thlorenz/doctoc)*

- [Introduction](#introduction)
  - [
Runtime Node Requirements
](#runtime-node-requirements)
  - [
    Network QoS Requirements
    ](#network-qos-requirements)
  - [
    Service Framework Requirements
    ](#service-framework-requirements)
  - [Objectives and Overview](#objectives-and-overview)
  - [Structure](#structure)
- [Requirements](#requirements)
- [State of the Art](#state-of-the-art)
  - [Security in Runtime](#security-in-runtime)
    - [Web Browsers](#web-browsers)
      - [Monolithic vs Modular Architectures](#monolithic-vs-modular-architectures)
      - [Browser Extensions Security](#browser-extensions-security)
      - [XSS Detection Techniques](#xss-detection-techniques)
      - [XSS (and Other Types) Prevention Techniques](#xss-and-other-types-prevention-techniques)
    - [**Automated Analysis of Security-Critical JavaScript APIs**](#automated-analysis-of-security-critical-JavaScript-apis)
    - [Secure Elements](#secure-elements)
      - [Java Card: Internet Computing on a Smart Card](#java-card-internet-computing-on-a-smart-card)
      - [Cloud of Secure Elements](#cloud-of-secure-elements)
      - [Defenses against Malicious Code](#defenses-against-malicious-code)
      - [**Getting malicious code on cards**](#getting-malicious-code-on-cards)
      - [Dynamic Countermeasures](#dynamic-countermeasures)
  - [Standards](#standards)
  - [Runtime](#runtime)
  - [Messaging](#messaging)
  - [Service Frameworks](#service-frameworks)
  - [Projects](#projects)
  - [Products](#products)
    - [ApiRTC](#apirtc)
      - [What is ApiRTC?](#what-is-apirtc)
      - [Features Overview](#features-overview)
      - [Architecture Overview](#architecture-overview)
      - [Architecture](#architecture)
      - [APIs](#apis)
      - [Requirements Analysis](#requirements-analysis)
      - [Integration in Rethink](#integration-in-rethink)
    - [State of the art of current WebRTC solutions of Quobis](#state-of-the-art-of-current-WebRTC-solutions-of-quobis)
      - [What is Sippo?](#what-is-sippo)
      - [What is a “WebRTC Application Controller”?](#what-is-a-%E2%80%9Cwebrtc-application-controller%E2%80%9D)
      - [Reference architecture](#reference-architecture)
      - [Understanding the role of a WebRTC Application Controller](#understanding-the-role-of-a-WebRTC-application-controller)
      - [Sippo interfaces and API’s](#sippo-interfaces-and-api%E2%80%99s)
        - [Sippo.js API](#sippojs-api)
        - [Sippo Service API (SAPI)](#sippo-service-api-sapi)
        - [Sippo connectors](#sippo-connectors)
        - [Sippo WebRTC API (WAPI)](#sippo-WebRTC-api-wapi)
      - [Sippo internals: services and backends](#sippo-internals-services-and-backends)
      - [1.7. Sippo WebRTC applications](#17-sippo-WebRTC-applications)
      - [Potential integration with Wonder proposal](#potential-integration-with-wonder-proposal)
        - [About signaling-on-the-fly](#about-signaling-on-the-fly)
        - [Signaling-on-the-fly versus multi-signaling support](#signaling-on-the-fly-versus-multi-signaling-support)
      - [Requirements Analysis](#requirements-analysis-1)
- [Hyperty Runtime Specification](#hyperty-runtime-specification)
  - [Runtime Architecture](#runtime-architecture)
    - [Service Provider Sandboxes](#service-provider-sandboxes)
      - [Hyperty](#hyperty)
      - [Policy Enforcer](#policy-enforcer)
      - [Protocol Stub](#protocol-stub)
    - [Core Runtime](#core-runtime)
      - [Message BUS](#message-bus)
      - [Policy Decision Point and Message BUS authorisation](#policy-decision-point-and-message-bus-authorisation)
      - [Message BUS Policy Enforcement Point](#message-bus-policy-enforcement-point)
      - [Runtime Registry](#runtime-registry)
      - [Identity Module](#identity-module)
      - [Runtime User Agent](#runtime-user-agent)
      - [QoS User Agent](#qos-user-agent)
    - [Native Runtime](#native-runtime)
  - [Security analysis of the Hyperty Runtime](#security-analysis-of-the-hyperty-runtime)
    - [Introduction](#introduction-1)
    - [Mitigated threats assuming an intact TCB](#mitigated-threats-assuming-an-intact-tcb)
      - [T1: Unauthorized access by client code](#t1-unauthorized-access-by-client-code)
      - [T2: Policy subversion](#t2-policy-subversion)
      - [T3: Threats to client code authenticity](#t3-threats-to-client-code-authenticity)
      - [T4: Denial of service attacks](#t4-denial-of-service-attacks)
    - [Vulnerability assessment of the Hyperty Runtime](#vulnerability-assessment-of-the-hyperty-runtime)
      - [Methodology](#methodology)
      - [Browser platform](#browser-platform)
      - [Standalone platform](#standalone-platform)
      - [M2M standalone application platform](#m2m-standalone-application-platform)
  - [Runtime APIs](#runtime-apis)
    - [Runtime User Agent Interface](#runtime-user-agent-interface)
      - [Local Device Runtime APIs](#local-device-runtime-apis)
        - [registerHyperty](#registerhyperty)
        - [loadHyperty](#loadhyperty)
        - [loadStub](#loadstub)
        - [checkForUpdate](#checkforupdate)
        - [discoverHiperty](#discoverhiperty)
      - [External parties procedures](#external-parties-procedures)
    - [Runtime Registry Interface](#runtime-registry-interface)
      - [init](#init)
      - [registerHyperty](#registerhyperty-1)
      - [unregisterHyperty](#unregisterhyperty)
      - [registerStub](#registerstub)
      - [unregisterStub](#unregisterstub)
      - [registerPEP](#registerpep)
      - [unregisterPEP](#unregisterpep)
      - [onEvent](#onevent)
      - [discoverProtostub](#discoverprotostub)
      - [getSandbox](#getsandbox)
      - [resolve](#resolve)
    - [Message BUS Interface](#message-bus-interface)
      - [postMessage](#postmessage)
      - [addListener](#addlistener)
      - [removeListener](#removelistener)
      - [addPEP](#addpep)
      - [removePEP](#removepep)
    - [Hyperty Interface](#hyperty-interface)
      - [init](#init-1)
      - [postMessage](#postmessage-1)
    - [Policy Enforcer Interface](#policy-enforcer-interface)
      - [init](#init-2)
      - [postMessage](#postmessage-2)
    - [protoStub Interface](#protostub-interface)
      - [init](#init-3)
      - [connect](#connect)
      - [disconnect](#disconnect)
      - [postMessage](#postmessage-3)
    - [Syncher](#syncher)
      - [setSender](#setsender)
      - [createAsObserver](#createasobserver)
      - [createAsReporter](#createasreporter)
      - [postMessage](#postmessage-4)
    - [Service Provider Sandbox interface](#service-provider-sandbox-interface)
      - [postMessage](#postmessage-5)
    - [Identity Module Interface](#identity-module-interface)
      - [generateAssertion](#generateassertion)
      - [validateAssertion](#validateassertion)
    - [Core Policy Decision Point (PDP) Interface](#core-policy-decision-point-pdp-interface)
      - [addPolicies](#addpolicies)
      - [removePolicies](#removepolicies)
      - [authorise](#authorise)
    - [Core Policy Enforcement Point (PEP) Interface](#core-policy-enforcement-point-pep-interface)
      - [enforce](#enforce)
    - [QoS User Agent Interface](#qos-user-agent-interface)
      - [getCurrentConnectivityStatistics](#getcurrentconnectivitystatistics)
      - [sendConnectivityStatisticsToBroker](#sendconnectivitystatisticstobroker)
  - [Runtime Main Procedures](#runtime-main-procedures)
    - [Runtime Basic Procedures](#runtime-basic-procedures)
      - [Deploy Hyperty Runtime](#deploy-hyperty-runtime)
      - [Deploy Protocol Stub](#deploy-protocol-stub)
      - [Deploy Hyperty {#header-identifiers-in-html-latex-and-context}](#deploy-hyperty-header-identifiers-in-html-latex-and-context)
  - [](#)
  - [](#-1)
  - [](#-2)
  - [](#-3)
      - [Message Routing in Message BUS](#message-routing-in-message-bus)
      - [Intra-domain Local Communication](#intra-domain-local-communication)
      - [Intra-domain Remote Communication](#intra-domain-remote-communication)
      - [Inter-domain Local Communication](#inter-domain-local-communication)
      - [Inter-domain Remote Communication](#inter-domain-remote-communication)
    - [Runtime Identity Management Procedures](#runtime-identity-management-procedures)
      - [User Registration](#user-registration)
      - [Discovery](#discovery)
        - [Prepare Discovery](#prepare-discovery)
        - [Use Discovery](#use-discovery)
      - [Domain Login](#domain-login)
      - [Associate User Identity to Hyperty Instance](#associate-user-identity-to-hyperty-instance)
      - [User identity assertion](#user-identity-assertion)
    - [Main Runtime Procedures for H2H Communication](#main-runtime-procedures-for-h2h-communication)
      - [Main Runtime Procedures for Intra-domain H2H Communications](#main-runtime-procedures-for-intra-domain-h2h-communications)
        - [H2H Intradomain Communication - Alice invites Bob](#h2h-intradomain-communication---alice-invites-bob)
        - [H2H Intradomain Communication - Bob receives invitation](#h2h-intradomain-communication---bob-receives-invitation)
        - [H2H Intradomain Communication - Invitation Acknowledgement](#h2h-intradomain-communication---invitation-acknowledgement)
        - [Incoming call is notified to Bob's application and Alice is updated](#incoming-call-is-notified-to-bobs-application-and-alice-is-updated)
        - [Bob starts WebRTC API](#bob-starts-WebRTC-api)
        - [Synchronization of Alice's Data Object](#synchronization-of-alices-data-object)
        - [H2H Interdomain Communication - create communication](#h2h-interdomain-communication---create-communication)
        - [H2H Interdomain Communication - Bob receives invitation](#h2h-interdomain-communication---bob-receives-invitation)
        - [H2H Interdomain Communication - Invitation Acknowledgement](#h2h-interdomain-communication---invitation-acknowledgement)
        - [Incoming call is notified to Bob's application and Alice is updated](#incoming-call-is-notified-to-bobs-application-and-alice-is-updated-1)
        - [Bob starts WebRTC API](#bob-starts-WebRTC-api-1)
        - [Synchronization of Alice's Data Object](#synchronization-of-alices-data-object-1)
      - [M2M Device Bootstrap, Registration, Authorization](#m2m-device-bootstrap-registration-authorization)
      - [M2M Intra Communication : Context Discovery](#m2m-intra-communication--context-discovery)
      - [M2M Intra Communication : PUB-SUB Communication](#m2m-intra-communication--pub-sub-communication)
  - [Runtime Implementation Considerations](#runtime-implementation-considerations)
    - [Browser Runtime Implementation](#browser-runtime-implementation)
      - [General design considerations](#general-design-considerations)
      - [Description of the proposed implementation design.](#description-of-the-proposed-implementation-design)
        - [Service workers.](#service-workers)
          - [Hyperties and Protocol Stubs](#hyperties-and-protocol-stubs)
      - [Runtime Message Bus Core Component.](#runtime-message-bus-core-component)
      - [iFrames](#iframes)
        - [How to send media stream from the reTHINK iFrame to the Web App.](#how-to-send-media-stream-from-the-rethink-iframe-to-the-web-app)
          - [Practical implementation](#practical-implementation)
    - [Considerations about the implementation of Runtime for standalone applications](#considerations-about-the-implementation-of-runtime-for-standalone-applications)
      - [Crosswalk](#crosswalk)
      - [Crosswalk Architecture](#crosswalk-architecture)
      - [cordova /Ionic / phonegap](#cordova-ionic--phonegap)
      - [Cordova functionnal schema](#cordova-functionnal-schema)
      - [Cordova plugins](#cordova-plugins)
      - [Some plugin examples](#some-plugin-examples)
        - [iosRTC](#iosrtc)
        - [phoneRTC](#phonertc)
        - [Crosswalk-based Cordova Android](#crosswalk-based-cordova-android)
      - [Cordova vs PhoneGap](#cordova-vs-phonegap)
      - [Cordova vs Ionic](#cordova-vs-ionic)
      - [Webview](#webview)
        - [Webview WebRTC support](#webview-WebRTC-support)
        - [Crosswalk vs Webview](#crosswalk-vs-webview)
      - [OpenWebRTC](#openwebrtc)
      - [Selected solutions for the implementation:](#selected-solutions-for-the-implementation)
        - [Solutions that have already been tested :](#solutions-that-have-already-been-tested-)
          - [Android :](#android-)
          - [iOS :](#ios-)
          - [Android & iOS :](#android-&-ios-)
        - [Solution to be tested during the implementation :](#solution-to-be-tested-during-the-implementation-)
    - [Runtime implementation M2M standalone application](#runtime-implementation-m2m-standalone-application)
      - [Node.js Installation](#Node.js-installation)
      - [Design](#design)
      - [Code Snippets](#code-snippets)
      - [Other evaluated runtimes](#other-evaluated-runtimes)
- [Messaging Node Specification](#message-node-specification)
  - [Messaging Node Architecture](#messaging-node-architecture)
    - [Core Functionalities](#core-functionalities)
      - [Message BUS](#message-bus-1)
      - [Access Control](#access-control)
      - [Session Management](#session-management)
      - [Address Allocation Management](#address-allocation-management)
    - [Protocol Stub](#protocol-stub-1)
    - [Connectors](#connectors)
  - [Vertx Specification](#vertx-specification)
    - [Core Functionalities](#core-functionalities-1)
      - [Pipeline](#pipeline)
      - [Session Management](#session-management-1)
      - [Address Allocation Management](#address-allocation-management-1)
      - [Access Control](#access-control-1)
      - [Message BUS](#message-bus-2)
    - [Protocol Stub Sandbox](#protocol-stub-sandbox)
    - [Connectors](#connectors-1)
      - [End User Device Connector](#end-user-device-connector)
      - [Network Server Connector](#network-server-connector)
      - [Registry Connector](#registry-connector)
      - [IdM Connector](#idm-connector)
  - [Node.js based Messaging Node Specification](#Node.js-based-messaging-node-specification)
    - [Core Functionalities](#core-functionalities-2)
      - [Message BUS](#message-bus-3)
        - [Usage of Redis with Node.js](#usage-of-redis-with-Node.js)
      - [Access Control](#access-control-2)
      - [Session Management](#session-management-2)
      - [Address Allocation Management](#address-allocation-management-2)
      - [Protocol Stub & Connectors](#protocol-stub-&-connectors)
        - [IdM Connector](#idm-connector-1)
        - [Registry Connector](#registry-connector-1)
        - [End-User Device Connector](#end-user-device-connector)
        - [Network Server Connector](#network-server-connector-1)
        - [Node Sandbox framework](#node-sandbox-framework)
    - [Node.js implementation architecture](#Node.js-implementation-architecture)
  - [Matrix.org based Messaging Node Specification](#matrixorg-based-messaging-node-specification)
    - [Protocol Stub and Connectors](#protocol-stub-and-connectors)
      - [Matrix as Protocol-on-the-fly client](#matrix-as-protocol-on-the-fly-client)
      - [Matrix as Protocol-on-the-fly server](#matrix-as-protocol-on-the-fly-server)
      - [Connectors in Matrix](#connectors-in-matrix)
    - [Core Functionalities](#core-functionalities-3)
      - [Message Bus](#message-bus)
      - [Access Control](#access-control-3)
      - [Session Management](#session-management-3)
        - [User session control](#user-session-control)
        - [Communication session control](#communication-session-control)
        - [Stub and connector management](#stub-and-connector-management)
      - [Address Allocation Management](#address-allocation-management-3)
- [Conclusions](#conclusions)
- [References](#references)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->